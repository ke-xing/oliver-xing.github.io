import{i as le,F as Ve,J as ue,g as we,m as de,K as ze,l as Pe,r as Re,c as De,d as ce,_ as Fe,E as He,T as Ne,L as fe,M as Ue,h as me}from"./base-6cbc4ee3.js";import{o as Ee,E as Me,q as Ye,p as We,n as Ke}from"./el-input-1ef0e24d.js";import{u as Xe,E as pe}from"./admin-953a90fe.js";import{o as Be,P as qe,a as ke,X as je,a5 as Ge,w as te,a6 as Je,N as _,Q as D,d as Se,t as m,e as se,M as Ze,c as O,r as b,L as Qe,Z as xe,R as $,h as g,v as E,x as p,l as ee,S as y,n as c,k as ve,Y as q,j as Z,_ as j,z as A,J as R,a0 as G,U as F,D as ne,E as _e,O as Te,a7 as Ie,a8 as Le,a9 as ge,q as en,i as ye,F as nn}from"./index-241ddf22.js";import{P as oe}from"./vnode-74e62ed9.js";import{E as on}from"./aria-60e0cdc6.js";import{o as he,E as tn}from"./focus-trap-8dd2731b.js";import{t as sn,c as be}from"./index-c7313fb7.js";import"./use-form-common-props-92f01474.js";let J;const an=e=>{var n;if(!le)return 0;if(J!==void 0)return J;const t=document.createElement("div");t.className=`${e}-scrollbar__wrap`,t.style.visibility="hidden",t.style.width="100px",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);const l=t.offsetWidth;t.style.overflow="scroll";const a=document.createElement("div");a.style.width="100%",t.appendChild(a);const s=a.offsetWidth;return(n=t.parentNode)==null||n.removeChild(t),J=l-s,J},ln=e=>["",...Ve].includes(e),rn=(e,n,t)=>{let l={offsetX:0,offsetY:0};const a=u=>{const f=u.clientX,o=u.clientY,{offsetX:v,offsetY:h}=l,i=e.value.getBoundingClientRect(),N=i.left,U=i.top,C=i.width,Y=i.height,B=document.documentElement.clientWidth,I=document.documentElement.clientHeight,W=-N+v,Q=-U+h,x=B-N-C+v,k=I-U-Y+h,z=X=>{const S=Math.min(Math.max(v+X.clientX-f,W),x),P=Math.min(Math.max(h+X.clientY-o,Q),k);l={offsetX:S,offsetY:P},e.value.style.transform=`translate(${ue(S)}, ${ue(P)})`},K=()=>{document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",K)};document.addEventListener("mousemove",z),document.addEventListener("mouseup",K)},s=()=>{n.value&&e.value&&n.value.addEventListener("mousedown",a)},r=()=>{n.value&&e.value&&n.value.removeEventListener("mousedown",a)};Be(()=>{qe(()=>{t.value?s():r()})}),ke(()=>{r()})},un=(e,n={})=>{je(e)||sn("[useLockscreen]","You need to pass a ref param to this function");const t=n.ns||we("popup"),l=Ge(()=>t.bm("parent","hidden"));if(!le||de(document.body,l.value))return;let a=0,s=!1,r="0";const u=()=>{setTimeout(()=>{Re(document==null?void 0:document.body,l.value),s&&document&&(document.body.style.width=r)},200)};te(e,f=>{if(!f){u();return}s=!de(document.body,l.value),s&&(r=document.body.style.width),a=an(t.namespace.value);const o=document.documentElement.clientHeight<document.body.scrollHeight,v=ze(document.body,"overflowY");a>0&&(o||v==="scroll")&&s&&(document.body.style.width=`calc(100% - ${a}px)`),Pe(document.body,l.value)}),Je(()=>u())},Oe=e=>{if(!e)return{onClick:_,onMousedown:_,onMouseup:_};let n=!1,t=!1;return{onClick:r=>{n&&t&&e(r),n=t=!1},onMousedown:r=>{n=r.target===r.currentTarget},onMouseup:r=>{t=r.target===r.currentTarget}}},ae="_trap-focus-children",T=[],Ce=e=>{if(T.length===0)return;const n=T[T.length-1][ae];if(n.length>0&&e.code===on.tab){if(n.length===1){e.preventDefault(),document.activeElement!==n[0]&&n[0].focus();return}const t=e.shiftKey,l=e.target===n[0],a=e.target===n[n.length-1];l&&t&&(e.preventDefault(),n[n.length-1].focus()),a&&!t&&(e.preventDefault(),n[0].focus())}},dn={beforeMount(e){e[ae]=he(e),T.push(e),T.length<=1&&document.addEventListener("keydown",Ce)},updated(e){D(()=>{e[ae]=he(e)})},unmounted(){T.shift(),T.length===0&&document.removeEventListener("keydown",Ce)}},cn=De({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:ce([String,Array,Object])},zIndex:{type:ce([String,Number])}}),fn={click:e=>e instanceof MouseEvent},mn="overlay";var pn=Se({name:"ElOverlay",props:cn,emits:fn,setup(e,{slots:n,emit:t}){const l=we(mn),a=f=>{t("click",f)},{onClick:s,onMousedown:r,onMouseup:u}=Oe(e.customMaskEvent?void 0:a);return()=>e.mask?m("div",{class:[l.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:s,onMousedown:r,onMouseup:u},[se(n,"default")],oe.STYLE|oe.CLASS|oe.PROPS,["onClick","onMouseup","onMousedown"]):Ze("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[se(n,"default")])}});const vn=pn,gn=Se({name:"ElMessageBox",directives:{TrapFocus:dn},components:{ElButton:Ee,ElFocusTrap:tn,ElInput:Me,ElOverlay:vn,ElIcon:He,...Ne},inheritAttrs:!1,props:{buttonSize:{type:String,validator:ln},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:n}){const{locale:t,zIndex:l,ns:a,size:s}=Ye("message-box",O(()=>e.buttonSize)),{t:r}=t,{nextZIndex:u}=l,f=b(!1),o=Qe({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:u()}),v=O(()=>{const d=o.type;return{[a.bm("icon",d)]:d&&fe[d]}}),h=be(),i=be(),N=O(()=>o.icon||fe[o.type]||""),U=O(()=>!!o.message),C=b(),Y=b(),B=b(),I=b(),W=b(),Q=O(()=>o.confirmButtonClass);te(()=>o.inputValue,async d=>{await D(),e.boxType==="prompt"&&d!==null&&P()},{immediate:!0}),te(()=>f.value,d=>{var w,L;d&&(e.boxType!=="prompt"&&(o.autofocus?B.value=(L=(w=W.value)==null?void 0:w.$el)!=null?L:C.value:B.value=C.value),o.zIndex=u()),e.boxType==="prompt"&&(d?D().then(()=>{var ie;I.value&&I.value.$el&&(o.autofocus?B.value=(ie=$e())!=null?ie:C.value:B.value=C.value)}):(o.editorErrorMessage="",o.validateError=!1))});const x=O(()=>e.draggable);rn(C,Y,x),Be(async()=>{await D(),e.closeOnHashChange&&window.addEventListener("hashchange",k)}),ke(()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",k)});function k(){f.value&&(f.value=!1,D(()=>{o.action&&n("action",o.action)}))}const z=()=>{e.closeOnClickModal&&S(o.distinguishCancelAndClose?"close":"cancel")},K=Oe(z),X=d=>{if(o.inputType!=="textarea")return d.preventDefault(),S("confirm")},S=d=>{var w;e.boxType==="prompt"&&d==="confirm"&&!P()||(o.action=d,o.beforeClose?(w=o.beforeClose)==null||w.call(o,d,o,k):k())},P=()=>{if(e.boxType==="prompt"){const d=o.inputPattern;if(d&&!d.test(o.inputValue||""))return o.editorErrorMessage=o.inputErrorMessage||r("el.messagebox.error"),o.validateError=!0,!1;const w=o.inputValidator;if(typeof w=="function"){const L=w(o.inputValue);if(L===!1)return o.editorErrorMessage=o.inputErrorMessage||r("el.messagebox.error"),o.validateError=!0,!1;if(typeof L=="string")return o.editorErrorMessage=L,o.validateError=!0,!1}}return o.editorErrorMessage="",o.validateError=!1,!0},$e=()=>{const d=I.value.$refs;return d.input||d.textarea},re=()=>{S("close")},Ae=()=>{e.closeOnPressEscape&&re()};return e.lockScroll&&un(f),{...xe(o),ns:a,overlayEvent:K,visible:f,hasMessage:U,typeClass:v,contentId:h,inputId:i,btnSize:s,iconComponent:N,confirmButtonClasses:Q,rootRef:C,focusStartRef:B,headerRef:Y,inputRef:I,confirmRef:W,doClose:k,handleClose:re,onCloseRequested:Ae,handleWrapperClick:z,handleInputEnter:X,handleAction:S,t:r}}}),yn=["aria-label","aria-describedby"],hn=["aria-label"],bn=["id"];function Cn(e,n,t,l,a,s){const r=$("el-icon"),u=$("close"),f=$("el-input"),o=$("el-button"),v=$("el-focus-trap"),h=$("el-overlay");return g(),E(_e,{name:"fade-in-linear",onAfterLeave:n[11]||(n[11]=i=>e.$emit("vanish")),persisted:""},{default:p(()=>[ee(m(h,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:p(()=>[y("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:c(`${e.ns.namespace.value}-overlay-message-box`),onClick:n[8]||(n[8]=(...i)=>e.overlayEvent.onClick&&e.overlayEvent.onClick(...i)),onMousedown:n[9]||(n[9]=(...i)=>e.overlayEvent.onMousedown&&e.overlayEvent.onMousedown(...i)),onMouseup:n[10]||(n[10]=(...i)=>e.overlayEvent.onMouseup&&e.overlayEvent.onMouseup(...i))},[m(v,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:p(()=>[y("div",{ref:"rootRef",class:c([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:ve(e.customStyle),tabindex:"-1",onClick:n[7]||(n[7]=q(()=>{},["stop"]))},[e.title!==null&&e.title!==void 0?(g(),Z("div",{key:0,ref:"headerRef",class:c(e.ns.e("header"))},[y("div",{class:c(e.ns.e("title"))},[e.iconComponent&&e.center?(g(),E(r,{key:0,class:c([e.ns.e("status"),e.typeClass])},{default:p(()=>[(g(),E(j(e.iconComponent)))]),_:1},8,["class"])):A("v-if",!0),y("span",null,R(e.title),1)],2),e.showClose?(g(),Z("button",{key:0,type:"button",class:c(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:n[0]||(n[0]=i=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),onKeydown:n[1]||(n[1]=G(q(i=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"]))},[m(r,{class:c(e.ns.e("close"))},{default:p(()=>[m(u)]),_:1},8,["class"])],42,hn)):A("v-if",!0)],2)):A("v-if",!0),y("div",{id:e.contentId,class:c(e.ns.e("content"))},[y("div",{class:c(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(g(),E(r,{key:0,class:c([e.ns.e("status"),e.typeClass])},{default:p(()=>[(g(),E(j(e.iconComponent)))]),_:1},8,["class"])):A("v-if",!0),e.hasMessage?(g(),Z("div",{key:1,class:c(e.ns.e("message"))},[se(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(g(),E(j(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(g(),E(j(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:p(()=>[F(R(e.dangerouslyUseHTMLString?"":e.message),1)]),_:1},8,["for"]))])],2)):A("v-if",!0)],2),ee(y("div",{class:c(e.ns.e("input"))},[m(f,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":n[2]||(n[2]=i=>e.inputValue=i),type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:c({invalid:e.validateError}),onKeydown:G(e.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),y("div",{class:c(e.ns.e("errormsg")),style:ve({visibility:e.editorErrorMessage?"visible":"hidden"})},R(e.editorErrorMessage),7)],2),[[ne,e.showInput]])],10,bn),y("div",{class:c(e.ns.e("btns"))},[e.showCancelButton?(g(),E(o,{key:0,loading:e.cancelButtonLoading,class:c([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:n[3]||(n[3]=i=>e.handleAction("cancel")),onKeydown:n[4]||(n[4]=G(q(i=>e.handleAction("cancel"),["prevent"]),["enter"]))},{default:p(()=>[F(R(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["loading","class","round","size"])):A("v-if",!0),ee(m(o,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,class:c([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:n[5]||(n[5]=i=>e.handleAction("confirm")),onKeydown:n[6]||(n[6]=G(q(i=>e.handleAction("confirm"),["prevent"]),["enter"]))},{default:p(()=>[F(R(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["loading","class","round","disabled","size"]),[[ne,e.showConfirmButton]])],2)],6)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,yn)]),_:3},8,["z-index","overlay-class","mask"]),[[ne,e.visible]])]),_:3})}var wn=Fe(gn,[["render",Cn],["__file","/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue"]]);const H=new Map,En=e=>{let n=document.body;return e.appendTo&&(Te(e.appendTo)&&(n=document.querySelector(e.appendTo)),me(e.appendTo)&&(n=e.appendTo),me(n)||(n=document.body)),n},Mn=(e,n,t=null)=>{const l=m(wn,e,ye(e.message)||Ie(e.message)?{default:ye(e.message)?e.message:()=>e.message}:null);return l.appContext=t,Le(l,n),En(e).appendChild(n.firstElementChild),l.component},Bn=()=>document.createElement("div"),kn=(e,n)=>{const t=Bn();e.onVanish=()=>{Le(null,t),H.delete(a)},e.onAction=s=>{const r=H.get(a);let u;e.showInput?u={value:a.inputValue,action:s}:u=s,e.callback?e.callback(u,l.proxy):s==="cancel"||s==="close"?e.distinguishCancelAndClose&&s!=="cancel"?r.reject("close"):r.reject("cancel"):r.resolve(u)};const l=Mn(e,t,n),a=l.proxy;for(const s in e)ge(e,s)&&!ge(a.$props,s)&&(a[s]=e[s]);return a.visible=!0,a};function V(e,n=null){if(!le)return Promise.reject();let t;return Te(e)||Ie(e)?e={message:e}:t=e.callback,new Promise((l,a)=>{const s=kn(e,n??V._context);H.set(s,{options:e,callback:t,resolve:l,reject:a})})}const Sn=["alert","confirm","prompt"],Tn={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};Sn.forEach(e=>{V[e]=In(e)});function In(e){return(n,t,l,a)=>{let s="";return en(t)?(l=t,s=""):Ue(t)?s="":s=t,V(Object.assign({title:s,message:n,type:"",...Tn[e]},l,{boxType:e}),a)}}V.close=()=>{H.forEach((e,n)=>{n.doClose()}),H.clear()};V._context=null;const M=V;M.install=e=>{M._context=e._context,e.config.globalProperties.$msgbox=M,e.config.globalProperties.$messageBox=M,e.config.globalProperties.$alert=M.alert,e.config.globalProperties.$confirm=M.confirm,e.config.globalProperties.$prompt=M.prompt};const Ln=M;const On=y("div",null,"安全中心",-1),$n=y("br",null,null,-1),Un={__name:"Security",setup(e){const n=b({password:"",newpassword:""});Xe();const t=b(),l=b({password:[{required:!0,message:"原密码不能为空",trigger:"blur"}],newpassword:[{required:!0,message:"新密码不能为空",trigger:"blur"}]}),a=(r,u)=>{Ln.confirm("确认要修改密码吗？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{pe({type:"success",message:"Delete completed"})}).catch(()=>{pe({type:"info",message:"Delete canceled"})})},s=()=>{n.value.password="",n.value.newpassword=""};return(r,u)=>{const f=Me,o=Ke,v=Ee,h=We;return g(),Z(nn,null,[On,$n,m(h,{class:"form","label-position":"left","label-width":"80px",model:n.value,rules:l.value,ref_key:"form",ref:t},{default:p(()=>[m(o,{label:"原密码",prop:"password"},{default:p(()=>[m(f,{placeholder:"请输入原始密码",modelValue:n.value.password,"onUpdate:modelValue":u[0]||(u[0]=i=>n.value.password=i)},null,8,["modelValue"])]),_:1}),m(o,{label:"新密码",prop:"newpassword"},{default:p(()=>[m(f,{placeholder:"请输入新密码",modelValue:n.value.newpassword,"onUpdate:modelValue":u[1]||(u[1]=i=>n.value.newpassword=i)},null,8,["modelValue"])]),_:1}),m(o,null,{default:p(()=>[m(v,{type:"primary",onClick:u[2]||(u[2]=i=>a(n.value.password,n.value.newpassword))},{default:p(()=>[F("修改密码")]),_:1}),m(v,{onClick:s},{default:p(()=>[F("重置")]),_:1})]),_:1})]),_:1},8,["model","rules"])],64)}}};export{Un as default};
